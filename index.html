<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>École Ohr Joseph — Connexion & Inscriptions personnel</title>
  <meta name="color-scheme" content="light dark">
  <style>
    :root{--bg:#0b1020;--panel:#0f172a;--muted:#94a3b8;--text:#e5e7eb;--brand:#22c55e;--brand2:#f59e0b;--error:#ef4444;--ok:#10b981}
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:linear-gradient(135deg,#0b1220,#13233d);}
    header{background:linear-gradient(90deg,#0e7490,#10b981);padding:14px 18px;color:#fff;position:sticky;top:0;z-index:10}
    .wrap{max-width:1100px;margin:0 auto;padding:28px 16px;color:var(--text)}
    h1{font-size:clamp(24px,3.2vw,36px);margin:0 0 6px}
    p.lead{color:var(--muted);margin:0 0 22px}
    nav a{display:inline-block;margin-right:10px;padding:8px 14px;border-radius:999px;background:rgba(255,255,255,.15);color:#fff;text-decoration:none}
    .grid{display:grid;grid-template-columns:1fr;gap:18px}
    @media(min-width:900px){.grid{grid-template-columns:1fr 1fr}}
    .card{background:rgba(15,23,42,.9);border:1px solid #1f2937;border-radius:16px;padding:18px}
    .card h2{margin:0 0 8px}
    label{display:block;margin:.6rem 0 .25rem}
    input,select{width:100%;padding:.8rem 1rem;border-radius:12px;border:1px solid #374151;background:#0b1220;color:#e5e7eb}
    button{cursor:pointer;border:0;border-radius:12px;padding:.85rem 1rem;font-weight:600}
    .btn-primary{background:linear-gradient(180deg,#fbbf24,#f59e0b);color:#141414}
    .row{display:flex;gap:.8rem;flex-wrap:wrap}
    .help{font-size:.9rem;color:var(--muted)}
    .msg{margin-top:.75rem;padding:.65rem .8rem;border-radius:10px}
    .msg.err{background:#331518;color:#fecaca;border:1px solid #7f1d1d}
    .msg.ok{background:#0d2320;color:#a7f3d0;border:1px solid #065f46}
    .footer{margin-top:28px;color:#9ca3af;text-align:center}
    a.link{color:#a7f3d0}
    .admin-link{display:inline-block;margin-left:10px}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <strong>École Ohr Joseph</strong>
      <nav class="admin-link">
        <a href="#admin" id="gotoAdmin">Administration</a>
        <a href="#" id="gotoHome">Accueil</a>
      </nav>
    </div>
  </header>

  <main class="wrap" id="home">
    <h1>Excellence & Tradition</h1>
    <p class="lead">Connexion du personnel et des professeurs. La création de compte nécessite la validation d’un administrateur.</p>

    <div class="grid">
      <!-- Connexion -->
      <section class="card">
        <h2>Connexion professeur / personnel</h2>
        <form id="loginForm" autocomplete="off">
          <label for="loginEmail">E-mail</label>
          <input id="loginEmail" name="email" type="email" required placeholder="prenom.nom@ecole.fr" />

          <label for="loginPassword">Mot de passe</label>
          <!-- IMPORTANT : name="password" -->
          <input id="loginPassword" name="password" type="password" required minlength="8" placeholder="********" />

          <div class="row" style="margin-top:12px">
            <button class="btn-primary" type="submit">Se connecter</button>
          </div>
          <div id="loginMsg" class="msg" style="display:none"></div>
        </form>
      </section>

      <!-- Création -->
      <section class="card">
        <h2>Créer un compte (validation admin requise)</h2>
        <form id="registerForm" autocomplete="off">
          <div class="row" style="gap:10px">
            <div style="flex:1">
              <label for="regName">Nom</label>
              <input id="regName" name="name" required />
            </div>
            <div style="flex:1">
              <label for="regSurname">Prénom</label>
              <input id="regSurname" name="surname" required />
            </div>
          </div>

          <div class="row" style="gap:10px">
            <div style="flex:1">
              <label for="regRole">Rôle</label>
              <select id="regRole" name="role" required>
                <option value="personnel">Personnel</option>
                <option value="prof">Professeur</option>
              </select>
            </div>
            <div style="flex:1">
              <label for="regClasse">Classe (si prof)</label>
              <input id="regClasse" name="classe" placeholder="ex: 6e A" />
            </div>
          </div>

          <label for="regEmail">E-mail</label>
          <input id="regEmail" name="email" type="email" required placeholder="prenom.nom@ecole.fr" />

          <label for="regPassword">Mot de passe</label>
          <!-- IMPORTANT : name="password" -->
          <input id="regPassword" name="password" type="password" required minlength="8" placeholder="********" />

          <div class="row" style="margin-top:12px">
            <button class="btn-primary" type="submit">Demander la création</button>
          </div>
          <p class="help">Un e-mail de confirmation est envoyé. Un administrateur doit valider votre compte avant la première connexion.</p>
          <div id="regMsg" class="msg" style="display:none"></div>
        </form>
      </section>
    </div>

    <p class="footer">© 2025 École Ohr Joseph — <a class="link" href="/admin.html">Espace Administration</a></p>
  </main>

  <!-- Section admin légère pour tester l'accès -->
  <section class="wrap" id="admin" style="display:none">
    <div class="card">
      <h2>Administration rapide (validation des utilisateurs)</h2>
      <form id="adminGate" class="row">
        <input id="adminCode" type="password" placeholder="Code administrateur" required />
        <button class="btn-primary" type="submit">Entrer</button>
      </form>
      <div id="adminMsg" class="msg" style="display:none"></div>
      <div id="adminPanel" style="display:none">
        <p class="help">Comptes en attente :</p>
        <ul id="pendingList"></ul>
      </div>
    </div>
  </section>

  <script type="module" src="/assets/app.js"></script>
</body>
</html>
